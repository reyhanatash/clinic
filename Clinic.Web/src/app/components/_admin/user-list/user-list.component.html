<div class="appContainer">
    <h4 class="text-right">لیست کاربران</h4>
    <hr>
    <div *ngIf="checkAccess(1)" class="col-12">
        <p-table id="usersTable" #dt styleClass="" class="contacts-table" [value]="usersList" [pageLinks]="20"
            [autoLayout]="true" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
            currentPageReportTemplate="نمایش {first} تا {last} " [rowsPerPageOptions]="[10,25,50]">
            <ng-template pTemplate="header">
                <tr>
                    <th>#</th>
                    <th pSortableColumn="firstName"><p-sortIcon field="firstName"></p-sortIcon>نام</th>
                    <th pSortableColumn="lastName"><p-sortIcon field="lastName"></p-sortIcon>نام خانوادگی</th>
                    <th>نام کاربری</th>
                    <th>فعال</th>
                    <th>نقش</th>
                    <th>عملیات</th>
                </tr>
                <tr>
                    <th></th>
                    <th>
                        <input type="text" (input)="dt.filter($event.target?.value, 'firstName', 'contains')"
                            class="form-control">
                    </th>
                    <th>
                        <input type="text" (input)="dt.filter($event.target?.value, 'lastName', 'contains')"
                            class="form-control">
                    </th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-user let-rowIndex="rowIndex">
                <tr>
                    <td> {{rowIndex+1}}</td>
                    <td class="text-center">
                        {{user.firstName}}
                    </td>
                    <td class="text-center">
                        {{user.lastName}}
                    </td>
                    <td class="text-center">
                        {{user.email}}
                    </td>
                    <td class="text-center">
                        {{user.isActive ? 'بله' : 'خیر'}}
                    </td>
                    <td class="text-center">
                        {{user.roleName}}
                    </td>
                    <td class="text-center">
                        <button class="btn main-btn" (click)="showtimeSchedule(user)">تنظیم زمان ها</button>
                        <button *ngIf="checkAccess(2)" class="btn btn-outline-secondary mx-1"
                            [routerLink]="['/user/new/' + user.id]">ویرایش</button>
                        <button *ngIf="checkAccess(3)" class="btn btn-outline-danger" (click)="deleteUser(user.id)">حذف</button>
                    </td>

                </tr>
            </ng-template>
        </p-table>
    </div>

    <p-dialog id="create-expense-modal" [(visible)]="showtimeModal" [closable]="true"
        [ngClass]="{'modalShadow' : showtimeModal}" class="p-2">
        <p-header>
            <h4>تنظیم زمان ها</h4>
        </p-header>
        <div class="col-12">
            <attendance-schedule [userId]="selectedScheduleUser"></attendance-schedule>
        </div>
    </p-dialog>
</div>